// Code generated by cmd/entgen from CUE ontology. DO NOT EDIT.
package schema

import (
	"regexp"

	"entgo.io/ent"
	"entgo.io/ent/schema/edge"
	"entgo.io/ent/schema/field"
	"entgo.io/ent/schema/mixin"
	"github.com/google/uuid"
	"github.com/matthewbaird/ontology/internal/types"
)

// Ensure mixin import is used.
var _ mixin.Schema

// Lease holds the schema definition for the Lease entity.
type Lease struct {
	ent.Schema
}

// Mixin of the Lease.
func (Lease) Mixin() []ent.Mixin {
	return []ent.Mixin{
		AuditMixin{},
	}
}

// Fields of the Lease.
func (Lease) Fields() []ent.Field {
	return []ent.Field{
		field.UUID("id", uuid.UUID{}).Default(uuid.New).Immutable().Comment("Primary key"),
		field.String("property_id").SchemaType(map[string]string{"postgres": "varchar"}),
		field.JSON("tenant_role_ids", []string{}),
		field.JSON("guarantor_role_ids", []string{}).Optional(),
		field.Enum("lease_type").Values("fixed_term", "month_to_month", "commercial_nnn", "commercial_gross", "commercial_modified_gross", "affordable", "section_8", "student"),
		field.Enum("status").Values("draft", "pending_approval", "pending_signature", "active", "expired", "month_to_month_holdover", "renewed", "terminated", "eviction"),
		field.JSON("term", &types.DateRange{}),
		field.Int64("base_rent_amount_cents").Comment("base_rent — amount in cents"),
		field.String("base_rent_currency").Default("USD").Match(regexp.MustCompile(`^[A-Z]{3}$`)).Comment("base_rent — ISO 4217 currency code"),
		field.Int64("security_deposit_amount_cents").Comment("security_deposit — amount in cents"),
		field.String("security_deposit_currency").Default("USD").Match(regexp.MustCompile(`^[A-Z]{3}$`)).Comment("security_deposit — ISO 4217 currency code"),
		field.JSON("rent_schedule", []types.RentScheduleEntry{}).Optional(),
		field.JSON("recurring_charges", []types.RecurringCharge{}).Optional(),
		field.JSON("late_fee_policy", &types.LateFeePolicy{}).Optional(),
		field.JSON("cam_terms", &types.CAMTerms{}).Optional(),
		field.JSON("tenant_improvement", &types.TenantImprovement{}).Optional(),
		field.JSON("renewal_options", []types.RenewalOption{}).Optional(),
		field.JSON("subsidy", &types.SubsidyTerms{}).Optional(),
		field.Time("move_in_date").Optional().Nillable(),
		field.Time("move_out_date").Optional().Nillable(),
		field.Time("notice_date").Optional().Nillable(),
		field.Int("notice_required_days"),
		field.Enum("signing_method").Values("electronic", "wet_ink", "both").Optional().Nillable(),
		field.Time("signed_at").Optional().Nillable(),
		field.String("document_id").Optional().Nillable().SchemaType(map[string]string{"postgres": "varchar"}),
	}
}

// Edges of the Lease.
func (Lease) Edges() []ent.Edge {
	return []ent.Edge{
		edge.From("unit", Unit.Type).Ref("leases").Unique().Comment("Unit has Leases over time (inverse)"),
		edge.From("occupied_unit", Unit.Type).Ref("active_lease").Unique().Comment("Unit has at most one active Lease (inverse)"),
		edge.To("tenant_roles", PersonRole.Type).Comment("Lease is held by tenant PersonRoles"),
		edge.To("guarantor_roles", PersonRole.Type).Comment("Lease is guaranteed by guarantor PersonRoles"),
		edge.To("ledger_entries", LedgerEntry.Type).Comment("Lease generates LedgerEntries"),
		edge.To("application", Application.Type).Unique().Comment("Lease originated from Application"),
	}
}

// ValidLeaseTransitions defines the allowed state machine transitions.
// Generated from CUE ontology state_machines.cue.
var ValidLeaseTransitions = map[string][]string{
	"active":                  {"expired", "month_to_month_holdover", "terminated", "eviction"},
	"draft":                   {"pending_approval", "pending_signature", "terminated"},
	"eviction":                {"terminated"},
	"expired":                 {"active", "month_to_month_holdover", "renewed", "terminated"},
	"month_to_month_holdover": {"active", "renewed", "terminated", "eviction"},
	"pending_approval":        {"draft", "pending_signature", "terminated"},
	"pending_signature":       {"active", "draft", "terminated"},
	"renewed":                 {},
	"terminated":              {},
}
