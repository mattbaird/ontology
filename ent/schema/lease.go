// Code generated by cmd/entgen from CUE ontology. DO NOT EDIT.
package schema

import (
	"regexp"

	"entgo.io/ent"
	"entgo.io/ent/schema/edge"
	"entgo.io/ent/schema/field"
	"entgo.io/ent/schema/mixin"
	"github.com/google/uuid"
	"github.com/matthewbaird/ontology/internal/types"
)

// Ensure mixin import is used.
var _ mixin.Schema

// Lease holds the schema definition for the Lease entity.
type Lease struct {
	ent.Schema
}

// Mixin of the Lease.
func (Lease) Mixin() []ent.Mixin {
	return []ent.Mixin{
		AuditMixin{},
	}
}

// Fields of the Lease.
func (Lease) Fields() []ent.Field {
	return []ent.Field{
		field.UUID("id", uuid.UUID{}).Default(uuid.New).Immutable().Comment("Primary key"),
		field.String("property_id").SchemaType(map[string]string{"postgres": "varchar"}),
		field.JSON("tenant_role_ids", []string{}),
		field.JSON("guarantor_role_ids", []string{}).Optional(),
		field.Enum("lease_type").Values("fixed_term", "month_to_month", "commercial_nnn", "commercial_nn", "commercial_n", "commercial_gross", "commercial_modified_gross", "affordable", "section_8", "student", "ground_lease", "short_term", "membership"),
		field.Enum("status").Values("draft", "pending_approval", "pending_signature", "active", "expired", "month_to_month_holdover", "renewed", "terminated", "eviction"),
		field.String("description").Optional().Nillable().SchemaType(map[string]string{"postgres": "varchar"}),
		field.Enum("liability_type").Values("joint_and_several", "individual", "by_the_bed", "proportional").Default("joint_and_several"),
		field.JSON("term", &types.DateRange{}),
		field.Time("lease_commencement_date").Optional().Nillable(),
		field.Time("rent_commencement_date").Optional().Nillable(),
		field.Int64("base_rent_amount_cents").Comment("base_rent — amount in cents"),
		field.String("base_rent_currency").Default("USD").Match(regexp.MustCompile(`^[A-Z]{3}$`)).Comment("base_rent — ISO 4217 currency code"),
		field.Int64("security_deposit_amount_cents").Comment("security_deposit — amount in cents"),
		field.String("security_deposit_currency").Default("USD").Match(regexp.MustCompile(`^[A-Z]{3}$`)).Comment("security_deposit — ISO 4217 currency code"),
		field.JSON("rent_schedule", []types.RentScheduleEntry{}).Optional(),
		field.JSON("recurring_charges", []types.RecurringCharge{}).Optional(),
		field.JSON("late_fee_policy", &types.LateFeePolicy{}).Optional(),
		field.JSON("cam_terms", &types.CAMTerms{}).Optional(),
		field.JSON("tenant_improvement", &types.TenantImprovement{}).Optional(),
		field.JSON("renewal_options", []types.RenewalOption{}).Optional(),
		field.JSON("usage_charges", []types.UsageBasedCharge{}).Optional(),
		field.JSON("percentage_rent", &types.PercentageRent{}).Optional(),
		field.JSON("expansion_rights", []types.ExpansionRight{}).Optional(),
		field.JSON("contraction_rights", []types.ContractionRight{}).Optional(),
		field.JSON("subsidy", &types.SubsidyTerms{}).Optional(),
		field.Time("move_in_date").Optional().Nillable(),
		field.Time("move_out_date").Optional().Nillable(),
		field.Time("notice_date").Optional().Nillable(),
		field.Int("notice_required_days"),
		field.String("check_in_time").Optional().Nillable().SchemaType(map[string]string{"postgres": "varchar"}),
		field.String("check_out_time").Optional().Nillable().SchemaType(map[string]string{"postgres": "varchar"}),
		field.Int64("cleaning_fee_amount_cents").Optional().Nillable().Comment("cleaning_fee — amount in cents"),
		field.String("cleaning_fee_currency").Optional().Nillable().Default("USD").Match(regexp.MustCompile(`^[A-Z]{3}$`)).Comment("cleaning_fee — ISO 4217 currency code"),
		field.String("platform_booking_id").Optional().Nillable().SchemaType(map[string]string{"postgres": "varchar"}),
		field.Enum("membership_tier").Values("hot_desk", "dedicated_desk", "office", "suite", "virtual").Optional().Nillable(),
		field.Bool("is_sublease").Default(false),
		field.Enum("sublease_billing").Values("through_master_tenant", "direct_to_landlord").Default("through_master_tenant"),
		field.Enum("signing_method").Values("electronic", "wet_ink", "both").Optional().Nillable(),
		field.Time("signed_at").Optional().Nillable(),
		field.String("document_id").Optional().Nillable().SchemaType(map[string]string{"postgres": "varchar"}),
	}
}

// Edges of the Lease.
func (Lease) Edges() []ent.Edge {
	return []ent.Edge{
		edge.To("lease_spaces", LeaseSpace.Type).Comment("LeaseSpace belongs to Lease (inverse)"),
		edge.To("tenant_roles", PersonRole.Type).Comment("Lease is held by tenant PersonRoles"),
		edge.To("guarantor_roles", PersonRole.Type).Comment("Lease is guaranteed by guarantor PersonRoles"),
		edge.To("ledger_entries", LedgerEntry.Type).Comment("Lease generates LedgerEntries"),
		edge.To("application", Application.Type).Unique().Comment("Lease originated from Application"),
		edge.To("subleases", Lease.Type).Comment("Lease has subleases"),
		edge.From("parent_lease", Lease.Type).Ref("subleases").Unique().Comment("Lease has subleases (inverse)"),
	}
}

// ValidLeaseTransitions defines the allowed state machine transitions.
// Generated from CUE ontology state_machines.cue.
var ValidLeaseTransitions = map[string][]string{
	"active":                  {"expired", "month_to_month_holdover", "terminated", "eviction"},
	"draft":                   {"pending_approval", "pending_signature", "terminated"},
	"eviction":                {"terminated"},
	"expired":                 {"active", "month_to_month_holdover", "renewed", "terminated"},
	"month_to_month_holdover": {"active", "renewed", "terminated", "eviction"},
	"pending_approval":        {"draft", "pending_signature", "terminated"},
	"pending_signature":       {"active", "draft", "terminated"},
	"renewed":                 {},
	"terminated":              {},
}
