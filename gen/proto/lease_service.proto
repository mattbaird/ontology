// Code generated by cmd/apigen from CUE ontology. DO NOT EDIT.
syntax = "proto3";

package propeller.v1;

option go_package = "github.com/matthewbaird/ontology/gen/proto;propellerv1";

import "google/protobuf/timestamp.proto";

// ─── Common Types ────────────────────────────────────────────────────────────

message Money {
  int64 amount_cents = 1;
  string currency = 2; // ISO 4217
}

message Address {
  string line1 = 1;
  string line2 = 2;
  string city = 3;
  string state = 4;
  string postal_code = 5;
  string country = 6;
  double latitude = 7;
  double longitude = 8;
  string county = 9;
}

message DateRange {
  google.protobuf.Timestamp start = 1;
  google.protobuf.Timestamp end = 2;
}

message ContactMethod {
  string type = 1;
  string value = 2;
  bool primary = 3;
  bool verified = 4;
  bool opt_out = 5;
  string label = 6;
}

message SideEffect {
  string entity_type = 1;
  string entity_id = 2;
  string description = 3;
}

// ─── Entity Messages ─────────────────────────────────────────────────────────

message Application {
  string id = 1;
  string property_id = 2;
  string unit_id = 3;
  string applicant_person_id = 4;
  string status = 5;
  google.protobuf.Timestamp desired_move_in = 6;
  int64 desired_lease_term_months = 7;
  string screening_request_id = 8;
  google.protobuf.Timestamp screening_completed = 9;
  int64 credit_score = 10;
  bool background_clear = 11;
  bool income_verified = 12;
  double income_to_rent_ratio = 13;
  string decision_by = 14;
  google.protobuf.Timestamp decision_at = 15;
  string decision_reason = 16;
  repeated string conditions = 17;
  Money application_fee = 18;
  bool fee_paid = 19;
  google.protobuf.Timestamp created_at = 20;
  google.protobuf.Timestamp updated_at = 21;
  string created_by = 22;
  string updated_by = 23;
  string source = 24;
}

message Lease {
  string id = 1;
  string unit_id = 2;
  string property_id = 3;
  repeated string tenant_role_ids = 4;
  repeated string guarantor_role_ids = 5;
  string lease_type = 6;
  string status = 7;
  DateRange term = 8;
  Money base_rent = 9;
  Money security_deposit = 10;
  repeated string rent_schedule = 11;
  repeated string recurring_charges = 12;
  string late_fee_policy = 13;
  string cam_terms = 14;
  string tenant_improvement = 15;
  repeated string renewal_options = 16;
  string subsidy = 17;
  google.protobuf.Timestamp move_in_date = 18;
  google.protobuf.Timestamp move_out_date = 19;
  google.protobuf.Timestamp notice_date = 20;
  int64 notice_required_days = 21;
  string signing_method = 22;
  google.protobuf.Timestamp signed_at = 23;
  string document_id = 24;
  google.protobuf.Timestamp created_at = 25;
  google.protobuf.Timestamp updated_at = 26;
  string created_by = 27;
  string updated_by = 28;
  string source = 29;
}

// ─── Service Definition ──────────────────────────────────────────────────────

service LeaseService {
  // Create a new lease draft
  rpc CreateLease(CreateLeaseRequest) returns (CreateLeaseResponse);
  // Get lease by ID
  rpc GetLease(GetLeaseRequest) returns (GetLeaseResponse);
  // List leases with filtering
  rpc ListLeases(ListLeasesRequest) returns (ListLeasesResponse);
  // Update lease fields (draft only)
  rpc UpdateLease(UpdateLeaseRequest) returns (UpdateLeaseResponse);
  // Submit lease draft for approval
  rpc SubmitForApproval(SubmitForApprovalRequest) returns (SubmitForApprovalResponse);
  // Approve lease for signing
  rpc ApproveLease(ApproveLeaseRequest) returns (ApproveLeaseResponse);
  // Activate a signed lease. Side effects: Unit status -> occupied, security deposit charge created
  rpc ActivateLease(ActivateLeaseRequest) returns (ActivateLeaseResponse);
  // Terminate a lease early. Requires reason for audit trail
  rpc TerminateLease(TerminateLeaseRequest) returns (TerminateLeaseResponse);
  // Renew a lease. Creates a new lease entity for the renewal term
  rpc RenewLease(RenewLeaseRequest) returns (RenewLeaseResponse);
  // Begin eviction process
  rpc StartEviction(StartEvictionRequest) returns (StartEvictionResponse);
  // Submit a new lease application
  rpc CreateApplication(CreateApplicationRequest) returns (CreateApplicationResponse);
  // Get application by ID
  rpc GetApplication(GetApplicationRequest) returns (GetApplicationResponse);
  // List applications
  rpc ListApplications(ListApplicationsRequest) returns (ListApplicationsResponse);
  // Approve a lease application
  rpc ApproveApplication(ApproveApplicationRequest) returns (ApproveApplicationResponse);
  // Deny a lease application. Reason required for fair housing compliance
  rpc DenyApplication(DenyApplicationRequest) returns (DenyApplicationResponse);
}

// ─── Request/Response Messages ───────────────────────────────────────────────

message CreateLeaseRequest {
  Lease lease = 1;
}

message CreateLeaseResponse {
  Lease lease = 1;
}

message GetLeaseRequest {
  string id = 1;
  repeated string include = 2; // Edge names to include
}

message GetLeaseResponse {
  Lease lease = 1;
}

message ListLeasesRequest {
  int32 page_size = 1;
  string page_token = 2;
  string filter = 3;
  string order_by = 4;
}

message ListLeasesResponse {
  repeated Lease leases = 1;
  string next_page_token = 2;
  int32 total_count = 3;
}

message UpdateLeaseRequest {
  Lease lease = 1;
  repeated string update_mask = 2; // Fields to update
}

message UpdateLeaseResponse {
  Lease lease = 1;
}

message SubmitForApprovalRequest {
  string id = 1;
}

message SubmitForApprovalResponse {
  Lease lease = 1;
  repeated SideEffect side_effects = 2;
}

message ApproveLeaseRequest {
  string id = 1;
}

message ApproveLeaseResponse {
  Lease lease = 1;
  repeated SideEffect side_effects = 2;
}

message ActivateLeaseRequest {
  string id = 1;
  string move_in_date = 2;
  string confirmed_rent = 3;
}

message ActivateLeaseResponse {
  Lease lease = 1;
  repeated SideEffect side_effects = 2;
}

message TerminateLeaseRequest {
  string id = 1;
  string reason = 2;
  string move_out_date = 3;
}

message TerminateLeaseResponse {
  Lease lease = 1;
  repeated SideEffect side_effects = 2;
}

message RenewLeaseRequest {
  string id = 1;
}

message RenewLeaseResponse {
  Lease lease = 1;
  repeated SideEffect side_effects = 2;
}

message StartEvictionRequest {
  string id = 1;
  string reason = 2;
}

message StartEvictionResponse {
  Lease lease = 1;
  repeated SideEffect side_effects = 2;
}

message CreateApplicationRequest {
  Application application = 1;
}

message CreateApplicationResponse {
  Application application = 1;
}

message GetApplicationRequest {
  string id = 1;
  repeated string include = 2; // Edge names to include
}

message GetApplicationResponse {
  Application application = 1;
}

message ListApplicationsRequest {
  int32 page_size = 1;
  string page_token = 2;
  string filter = 3;
  string order_by = 4;
}

message ListApplicationsResponse {
  repeated Application applications = 1;
  string next_page_token = 2;
  int32 total_count = 3;
}

message ApproveApplicationRequest {
  string id = 1;
  string conditions = 2;
}

message ApproveApplicationResponse {
  Application application = 1;
  repeated SideEffect side_effects = 2;
}

message DenyApplicationRequest {
  string id = 1;
  string reason = 2;
}

message DenyApplicationResponse {
  Application application = 1;
  repeated SideEffect side_effects = 2;
}

